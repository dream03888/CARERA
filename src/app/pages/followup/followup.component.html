<div class="board">

  <!-- LEFT : Issue List -->
  <div class="panel listPanel">
    <div class="panelTitle">Issue List</div>

    <div class="row"
         *ngFor="let issue of issues"
         (click)="selectIssue(issue)">

      <!-- Thumbnail -->
      <div class="thumb" *ngIf="issue.fix_photo">
        <img [src]="apiUrl + '/uploads/issues/' + issue.fix_photo"
             (click)="openPreview(issue.fix_photo); $event.stopPropagation()">
      </div>

      <div class="grow">
        <div class="name">{{ issue.zone_name }} â€” {{ issue.camera_point }}</div>
        <div class="meta">{{ getStatusLabel(issue.status) }}</div>
      </div>

      <span class="chip"
        [class.good]="issue.status == 1"
        [class.bad]="issue.status == 2"
        [class.warn]="issue.status == 3">
        {{ getStatusLabel(issue.status) }}
      </span>
    </div>
  </div>


  <!-- RIGHT : Issue Detail -->
  <div class="panel detailPanel" *ngIf="selectedIssue">

    <div class="panelTitle">Issue Detail</div>

    <div class="field">
      <div class="label">Camera</div>
      <div class="value">{{ selectedIssue.camera_point }}</div>
    </div>

    <div class="field">
      <div class="label">Zone</div>
      <div class="value">{{ selectedIssue.zone_name }}</div>
    </div>

    <!-- Status Dropdown -->
    <div class="field">
      <div class="label">Status</div>

      <div class="statusDropdown" (click)="toggleStatusDropdown()">
        <div class="selected">
          {{ getStatusLabel(selectedIssue.status) }}
          <span class="arrow">â–¾</span>
        </div>

        <div class="menu" *ngIf="statusOpen">
          <div class="item online" (click)="setStatus(1, $event)">ðŸŸ¢ Online</div>
          <div class="item offline" (click)="setStatus(2, $event)">ðŸ”´ Offline</div>
          <div class="item na" (click)="setStatus(3, $event)">ðŸŸ¡ N/A</div>
        </div>
      </div>
    </div>

    <!-- How to fix -->
    <div class="field">
      <div class="label">How to fix</div>
      <textarea class="textarea"
        [(ngModel)]="selectedIssue.fix_remark"
        placeholder="à¹€à¸Šà¹ˆà¸™ à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸à¸¥à¹‰à¸­à¸‡à¹ƒà¸«à¸¡à¹ˆ / à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸ªà¸²à¸¢ LAN">
      </textarea>
    </div>

    <!-- Attach photo -->
    <div class="field">
      <div class="label">Attach Photo</div>
      <input type="file" accept="image/*" capture="environment"
             (change)="onSelectImage($event)">
    </div>

<div class="preview" *ngIf="previewImage">
  <img [src]="previewImage" class="preview-img">
</div>

    <button class="btnSave" (click)="saveIssue()">ðŸ’¾ Save</button>

  </div>
</div>

<!-- Preview Fullscreen -->
<div class="previewModal" *ngIf="previewFull" (click)="closePreview()">
  <img [src]="apiUrl + '/uploads/issues/' + previewFull">
</div>
